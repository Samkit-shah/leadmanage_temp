import{t as T,j as e,T as q,P as B,F as k,h as E,a as O,b as w,c as _,e as l,i as z,aC as P,r as c,ao as R,ap as V,aq as L,f as i,A as S,ar as Y,B as y,aU as H,u as $,C as G,w as M,G as h,x as J,y as U,z as X,l as W,m as F,n as D,o as N,q as I,aV as K}from"./index-BBusEcbR.js";import{g as Q,a as Z,c as ee}from"./account.service-5BwnR_vM.js";import{a as te}from"./Style--b0mMLJA.js";import ae from"./index-CpiK-d31.js";function ne({rows:o,setOpen:d,setContactId:j}){const r=T();return e.jsxs(q,{component:B,children:[e.jsx(k,{color:"primary","aria-label":"add",size:"small",style:{float:"right",marginRight:"10px"},onClick:()=>d(!0),children:e.jsx(E,{})}),e.jsxs(O,{sx:{minWidth:650},"aria-label":"simple table",children:[e.jsx(w,{children:e.jsxs(_,{children:[e.jsx(l,{style:{fontWeight:"bolder"},children:"First Name"}),e.jsx(l,{align:"center",style:{fontWeight:"bolder"},children:"Phone No."}),e.jsx(l,{align:"center",style:{fontWeight:"bolder"},children:"Email"}),e.jsx(l,{align:"center",style:{fontWeight:"bolder"},children:"Company Name"}),e.jsx(l,{align:"center",style:{fontWeight:"bolder"},children:"Role"}),e.jsx(l,{align:"center",style:{fontWeight:"bolder"},children:"Created At"})]})}),e.jsx(z,{children:o.map(a=>e.jsxs(_,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(l,{component:"th",scope:"row",children:e.jsxs("a",{onClick:()=>r(`/user/contact/${a.id}`),href:"#",children:[a.first_name," ",a.last_name]})}),e.jsx(l,{align:"center",children:a.phone_number}),e.jsx(l,{align:"center",children:a.email}),e.jsx(l,{align:"center",children:a.company_name}),e.jsx(l,{align:"center",children:a.role}),e.jsx(l,{align:"center",children:P(a.createdAt).format("YYYY-MM-DD")})]},a.name))})]})]})}function se({open:o,setOpen:d,getContactListByAcccountId:j}){const[r,a]=c.useState([]),[A,p]=c.useState(),g=()=>{d(!1)},b=(n,s)=>{s&&p(u=>{const t={...u};return t.account_id=s.id,t})},x=n=>{p(s=>{const u={...s};return u[n.target.name]=n.target.value,u})},C=async n=>{try{n.preventDefault();const s=new FormData(n.currentTarget),u=Object.fromEntries(s.entries()),{msg:t}=await H(u);alert("Contact created successfully!"),j(),g()}catch(s){alert(s)}},f=async()=>{try{const{accounts:n}=await Q();a(n.map(s=>({id:s.id,label:s.account_name})))}catch(n){alert(n)}};return c.useEffect(()=>{f()},[]),e.jsx(c.Fragment,{children:e.jsx(R,{open:o,onClose:g,fullWidth:!0,maxWidth:"xs",className:"create-product-dialog",children:e.jsxs("form",{onSubmit:C,children:[e.jsx(V,{className:"dialog-title",children:"Create Account"}),e.jsxs(L,{children:[e.jsx(i,{autoFocus:!0,margin:"dense",id:"first_name",name:"first_name",label:"First Name",type:"text",fullWidth:!0,variant:"outlined",onChange:x,required:!0,className:"form-field"}),e.jsx("br",{}),e.jsx(i,{autoFocus:!0,margin:"dense",id:"last_name",name:"last_name",label:"Last Name",type:"text",fullWidth:!0,variant:"outlined",onChange:x,required:!0}),e.jsx("br",{}),e.jsx(i,{autoFocus:!0,margin:"dense",id:"phone_number",name:"phone_number",label:"Phone Number",fullWidth:!0,variant:"outlined",onChange:x,required:!0}),e.jsx("br",{}),e.jsx(i,{autoFocus:!0,margin:"dense",id:"email",name:"email",label:"Email",fullWidth:!0,variant:"outlined",onChange:x,required:!0}),e.jsx("br",{}),e.jsx(i,{autoFocus:!0,margin:"dense",id:"company_name",name:"company_name",label:"Company Name",fullWidth:!0,variant:"outlined",onChange:x,required:!0}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(S,{size:"small",name:"leadid",disablePortal:!0,id:"combo-box-demo",options:r,onChange:b,renderInput:n=>e.jsx(i,{variant:"outlined",...n,label:"Account",required:!0}),required:!0}),e.jsx("br",{}),e.jsx(S,{size:"small",name:"role",id:"combo-box-demo",options:[{label:"Finance"},{label:"Admin"},{label:"Shipping/Billing"},{label:"HR"},{label:"Delivery"}],renderInput:n=>e.jsx(i,{variant:"outlined",name:"role",...n,label:"Role",required:!0}),required:!0})]}),e.jsxs(Y,{children:[e.jsx(y,{variant:"contained",color:"error",onClick:g,children:"Cancel"}),e.jsx(y,{type:"submit",variant:"contained",color:"success",onClick:g,children:"Submit"})]})]})})})}function re({contacts:o,getContactListByAcccountId:d,id:j}){const[r,a]=c.useState(!1);return c.useState(null),e.jsxs(e.Fragment,{children:[e.jsx(ne,{rows:o,open:r,setOpen:a}),e.jsx(se,{open:r,setOpen:a,id:j,getContactListByAcccountId:d})]})}function de(){const[o,d]=c.useState({}),j=T(),{id:r}=$(),[a,A]=c.useState(null),[p,g]=c.useState([]),[b,x]=c.useState([]),C=async()=>{try{const{account:t,msg:m}=await Z(r);A(t),delete t.createdAt,delete t.updatedAt,d(t)}catch(t){alert(t)}},f=async()=>{try{const{opportunities:t}=await te(r);g(t)}catch(t){alert(t)}},n=t=>{try{d(m=>{const v={...m};return v[t.target.name]=t.target.value,v})}catch(m){alert(m)}},s=async()=>{try{const{contacts:t,msg:m}=await K(r);x(t)}catch(t){alert(t)}};c.useEffect(()=>{C(),f(),s()},[]);const u=async t=>{try{t.preventDefault(),o.id=a.id;const{msg:m}=await ee(o);alert("Account updated successfully!")}catch(m){alert(m)}};return e.jsx(e.Fragment,{children:e.jsxs(G,{maxWidth:"xl",className:"product-container",children:[e.jsx(y,{color:"primary",onClick:()=>j(-1),className:"back-button",children:e.jsx(M,{fontSize:"small",fontWeight:"bold",className:"back-button-icon"})}),a&&e.jsxs(h,{container:!0,spacing:2,children:[e.jsx(h,{item:!0,xl:6,xs:12,children:e.jsxs(J,{children:[e.jsx(U,{title:"Account Details"}),e.jsx(X,{children:e.jsxs("form",{onSubmit:u,children:[e.jsxs(h,{container:!0,spacing:2,children:[e.jsx(h,{item:!0,xl:6,xs:12,children:e.jsx(i,{fullWidth:!0,id:"account_name",name:"account_name",label:"Account Name",variant:"standard",onChange:n,defaultValue:a.account_name})}),e.jsx(h,{item:!0,xl:6,xs:12,children:e.jsx(i,{fullWidth:!0,id:"billing_address",name:"billing_address",label:"Billing Address",variant:"standard",onChange:n,defaultValue:a.billing_address})}),e.jsx(h,{item:!0,xl:6,xs:12,children:e.jsx(i,{fullWidth:!0,id:"name",name:"shipping_address",label:"Shipping Address",variant:"standard",onChange:n,defaultValue:a.shipping_address})}),e.jsx(h,{item:!0,xl:6,xs:12,children:e.jsx(i,{fullWidth:!0,id:"name",name:"total_amount",label:"Total Amount",variant:"standard",onChange:n,defaultValue:a.total_amount,disabled:!0})})]}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("center",{children:e.jsx(y,{type:"submit",size:"small",variant:"contained",color:"primary",children:"Save Changes"})})]})})]})}),e.jsxs(h,{item:!0,xl:6,xs:12,style:{width:"100%",overflowX:"scroll"},children:[e.jsxs(W,{children:[e.jsx(F,{expandIcon:e.jsx(D,{}),"aria-controls":"panel1-content",id:"panel1-header",children:e.jsx(N,{children:e.jsxs("p",{style:{fontWeight:"bolder"},children:["Contacts (",b.length,")"]})})}),e.jsx(I,{children:e.jsx(re,{id:r,contacts:b,getContactListByAcccountId:s})})]}),e.jsxs(W,{children:[e.jsx(F,{expandIcon:e.jsx(D,{}),"aria-controls":"panel1-content",id:"panel1-header",children:e.jsx(N,{children:e.jsxs("p",{style:{fontWeight:"bolder"},children:["Opportunities (",p.length,")"]})})}),e.jsx(I,{children:e.jsx(ae,{rows:p,getOpportunitiesByAccountId:f,accountId:r})})]})]})]})]})})}export{de as default};
