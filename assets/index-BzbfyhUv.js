import{r as l,j as e,l as D,m as T,n as V,o as b,q as L,aK as I,a7 as k,t as P,u as z,aL as B,a5 as F,C as p,B as j,w as G,G as t,f as i,A as g,P as U,aD as q}from"./index-BBusEcbR.js";import{a as R}from"./user.service-DiCLz2BP.js";import{A as H}from"./index-C7dUZSeJ.js";/* empty css              */import{C as _}from"./CircularProgress-BCXDau8U.js";function J(m){const[x,h]=l.useState([]),[c,s]=l.useState(0),o=async()=>{try{const{tasks:r}=await I(m.id);s(r.length),h(r.slice(0,4))}catch(r){alert(r.message)}};return l.useEffect(()=>{o()},[]),e.jsx("div",{className:"basic-accordion",children:e.jsxs(D,{className:"accordion-item",children:[e.jsx(T,{expandIcon:e.jsx(V,{}),"aria-controls":"panel1a-content",id:"panel1a-header",className:"accordion-summary",children:e.jsxs(b,{className:"accordion-title",children:["Tasks (",c,")"]})}),e.jsx(L,{className:"accordion-details",children:e.jsx(H,{isChild:!0,data:x,leadid:m.id,getTasks:o})})]})})}const K=sessionStorage.getItem("isAdmin")==="true";function Z({getAllLeads:m}){const x=k({palette:{primary:{main:"#21256C"},secondary:{main:"#e0f7fa"}},typography:{h1:{fontSize:"2.5rem",fontWeight:700,paddingBottom:"3rem"},h3:{fontSize:"2rem",fontWeight:500},h4:{fontSize:"1.25rem",fontWeight:700}}}),h=P(),{id:c}=z(),[s,o]=l.useState(null),[r,y]=l.useState(null),[S,N]=l.useState([]),[v,C]=l.useState(null),[W,f]=l.useState(null),A=["HOT","COLD","ASSIGNED","OPEN","CONVERTED"],O=(a,n)=>{n&&(f(n.label),C(n.id))},w=async a=>{try{const{users:n}=await R();n.push({name:"UNASSIGNED",id:-1});const d=n.map(u=>(u.id===a&&f(u.name),{label:u.name,id:u.id}));N(d)}catch(n){alert(n)}};l.useEffect(()=>{B(c).then(({lead:a})=>{o(a),y(a.status),w(a.ownerid)}).catch(a=>{alert(a.message)})},[c]);const E=async a=>{a.preventDefault();try{const n=new FormData(a.currentTarget),d=Object.fromEntries(n.entries());d.id=s.id,d.ownerid=v,d.isrenewal=n.get("isrenewal")==="on",await q(d),alert("Lead updated successfully!")}catch(n){alert(n)}};return e.jsx(F,{theme:x,children:s?e.jsx(p,{maxWidth:"xl",className:"edit-lead-container",children:e.jsxs(p,{maxWidth:"md",children:[e.jsx(j,{color:"primary",onClick:()=>h(-1),className:"back-button",children:e.jsx(G,{fontSize:"small",fontWeight:"bold",className:"back-button-icon"})}),e.jsx(b,{variant:"h5",className:"lead-status-header",children:"Lead Status"}),e.jsx("div",{className:"status-buttons-container",children:A.map(a=>e.jsx(j,{variant:"contained",color:r===a?"warning":"success",className:"status-button",children:a},a))}),e.jsxs(t,{container:!0,spacing:3,children:[e.jsx(t,{item:!0,xl:8,xs:12,children:e.jsxs("form",{autoComplete:"off",onSubmit:E,className:"lead-form",children:[e.jsxs(t,{container:!0,spacing:2,children:[e.jsx(t,{item:!0,xl:6,xs:12,children:e.jsx(i,{fullWidth:!0,id:"firstname",name:"firstname",label:"First Name",defaultValue:s.firstname,variant:"outlined"})}),e.jsx(t,{item:!0,xl:6,xs:12,children:e.jsx(i,{fullWidth:!0,id:"lastname",name:"lastname",label:"Last Name",defaultValue:s.lastname,variant:"outlined"})})]}),e.jsxs(t,{container:!0,spacing:2,children:[e.jsx(t,{item:!0,xl:6,xs:12,children:e.jsx(i,{fullWidth:!0,id:"source",name:"source",label:"Source",defaultValue:s.source,variant:"outlined"})}),e.jsx(t,{item:!0,xl:6,xs:12,children:e.jsx(i,{fullWidth:!0,id:"companyname",name:"companyname",label:"Company Name",defaultValue:s.companyname,variant:"outlined"})})]}),e.jsxs(t,{container:!0,spacing:2,children:[e.jsx(t,{item:!0,xl:6,xs:12,children:e.jsx(i,{fullWidth:!0,id:"shippingaddress",name:"shippingaddress",label:"Shipping Address",defaultValue:s.shippingaddress,variant:"outlined"})}),e.jsx(t,{item:!0,xl:6,xs:12,children:e.jsx(i,{fullWidth:!0,id:"billingaddress",name:"billingaddress",label:"Billing Address",defaultValue:s.billingaddress,variant:"outlined"})})]}),e.jsxs(t,{container:!0,spacing:2,children:[e.jsx(t,{item:!0,xl:6,xs:12,children:e.jsx(i,{fullWidth:!0,id:"interestedon",name:"interestedon",label:"Interested On",defaultValue:s.interestedon,variant:"outlined"})}),e.jsx(t,{item:!0,xl:6,xs:12,children:e.jsx(i,{fullWidth:!0,id:"description",name:"description",label:"Description",defaultValue:s.description,variant:"outlined"})})]}),e.jsxs(t,{container:!0,spacing:2,children:[e.jsx(t,{item:!0,xl:6,xs:12,children:e.jsx(g,{fullWidth:!0,size:"small",id:"combo-box-demo",defaultValue:s.status.toUpperCase(),options:[{label:"HOT"},{label:"COLD"},{label:"OPEN"},{label:"ASSIGNED"},{label:"CONVERTED"}],renderInput:a=>e.jsx(i,{variant:"outlined",name:"status",...a,label:"Status"})})}),e.jsx(t,{item:!0,xl:6,xs:12,children:e.jsx(i,{fullWidth:!0,type:"email",id:"email",name:"email",label:"Email",defaultValue:s.email,variant:"outlined"})})]}),e.jsxs(t,{container:!0,spacing:2,children:[e.jsx(t,{item:!0,xl:6,xs:12,children:e.jsx(i,{fullWidth:!0,type:"number",id:"scoring",name:"scoring",label:"Scoring",defaultValue:s.scoring,variant:"outlined"})}),e.jsx(t,{item:!0,xl:6,xs:12,children:e.jsx(i,{fullWidth:!0,id:"quality",name:"quality",label:"Quality",defaultValue:s.quality,variant:"outlined"})})]}),K&&e.jsx(t,{container:!0,spacing:2,children:e.jsx(t,{item:!0,xl:6,xs:12,children:e.jsx(g,{size:"small",id:"combo-box-demo",value:W,options:S,onChange:O,renderInput:a=>e.jsx(i,{variant:"outlined",...a,label:"Owner"})})})}),e.jsx(t,{container:!0,justifyContent:"center",children:e.jsx(j,{variant:"contained",type:"submit",color:"primary",className:"submit-button",children:"Save Changes"})})]})}),e.jsx(t,{item:!0,xl:4,xs:12,children:e.jsx(U,{className:"accordion-container",children:e.jsx(J,{id:s.id})})})]})]})}):e.jsx("center",{children:e.jsx(_,{})})})}export{Z as default};
